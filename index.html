<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Haunt Map - Paranormal Locations</title>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css" />
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
 
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #0f0f0f 0%, #1a0a0a 100%);
            color: #ffffff;
            min-height: 100vh;
            overflow-x: hidden;
        }
 
        .header {
            background: linear-gradient(135deg, #2c1810, #4a2c17);
            padding: 20px 0;
            text-align: center;
            box-shadow: 0 2px 20px rgba(255, 107, 53, 0.3);
        }
 
        .header-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 20px;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            text-align: center;
        }
 
        .header-logo {
            max-height: 80px;
            max-width: 200px;
            height: auto;
            filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.7));
            flex-shrink: 0;
        }
 
        .header-text {
            text-align: center;
        }
 
        .header h1 {
            font-size: 2.5em;
            color: #ff6b35;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.7);
            margin-bottom: 10px;
        }
 
        .header p {
            color: #cccccc;
            font-size: 1.1em;
        }
 
        @media (max-width: 768px) {
            .header-content {
                 gap: 15px;
             }
            
             .header-logo {
                max-height: 60px;
            }
        }
 
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
 
        .map-controls {
            background: rgba(42, 42, 42, 0.9);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }
 
        .control-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
 
        .control-group label {
            color: #ff6b35;
            font-size: 0.9em;
            font-weight: bold;
        }
 
        select, input {
            padding: 8px;
            border: 1px solid #555;
            border-radius: 5px;
            background: #333;
            color: white;
            font-size: 14px;
        }
 
        .generate-btn {
            background: linear-gradient(135deg, #ff6b35, #e55a2e);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            font-size: 16px;
            transition: all 0.3s ease;
            margin-left: auto;
        }
 
        .generate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 53, 0.4);
        }
 
        .map-container {
            background: rgba(42, 42, 42, 0.9);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }
 
        #map {
            width: 100%;
            height: 500px;
            border-radius: 10px;
            border: 2px solid #444;
            position: relative;
            z-index: 1;
        }
 
        /* Custom marker styles */
        .haunted-marker {
            background: radial-gradient(circle, #ff6b35, #cc4a1a);
            border: 2px solid #ff8c42;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            box-shadow: 0 2px 10px rgba(255, 107, 53, 0.7);
            animation: pulse 2s infinite;
            cursor: pointer;
            transition: opacity 0.3s ease;
        }
        
        .haunted-marker:hover,
        .haunted-marker.selected {
            opacity: 0.4;
        }
 
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 107, 53, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(255, 107, 53, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 107, 53, 0); }
        }
 
        /* Custom popup styles */
        .leaflet-popup-content-wrapper {
            background: rgba(0, 0, 0, 0.95) !important;
            border: 2px solid #ff6b35 !important;
            border-radius: 10px !important;
            color: #fff !important;
        }
 
        .leaflet-popup-content {
            color: #fff !important;
            margin: 15px !important;
        }
 
        .leaflet-popup-content h3 {
            color: #ff6b35 !important;
            margin-bottom: 8px !important;
            font-size: 1.1em !important;
        }
 
        .leaflet-popup-content p {
            color: #ccc !important;
            font-size: 0.9em !important;
            line-height: 1.4 !important;
        }
 
        .leaflet-popup-tip {
            background: rgba(0, 0, 0, 0.95) !important;
            border: 2px solid #ff6b35 !important;
        }
 
        .leaflet-popup-close-button {
            color: #ff6b35 !important;
            font-size: 18px !important;
            font-weight: bold !important;
        }
 
        .locations-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
 
        .location-card {
            background: linear-gradient(145deg, #2a2a2a, #1f1f1f);
            border: 1px solid #444;
            border-radius: 15px;
            padding: 20px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
 
        .location-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #ff6b35, #ff8c42, #ff6b35);
        }
 
        .location-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(255, 107, 53, 0.2);
            border-color: #ff6b35;
        }
 
        /* Location Image Styling */
        .location-image {
            width: 100%;
            height: 200px;
            overflow: hidden;
            border-radius: 10px;
            margin-bottom: 15px;
        }
 
        .location-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }
 
        .location-card:hover .location-image img {
            transform: scale(1.05);
        }
 
        /* Mobile responsive */
        @media (max-width: 768px) {
            .location-image {
                height: 150px;
            }
        }
 
        .location-title {
            color: #ff6b35;
            font-size: 1.3em;
            margin-bottom: 10px;
            font-weight: bold;
        }
 
        .location-type {
            display: inline-block;
            background: rgba(255, 107, 53, 0.2);
            color: #ff6b35;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.8em;
            margin-bottom: 15px;
            border: 1px solid #ff6b35;
        }
 
        .location-story {
            color: #ccc;
            line-height: 1.6;
            margin-bottom: 15px;
        }
 
        .location-features {
            border-top: 1px solid #333;
            padding-top: 15px;
        }
 
        .location-features h4 {
            color: #ff6b35;
            font-size: 0.9em;
            margin-bottom: 8px;
        }
 
        .features-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
 
        .feature-tag {
            background: rgba(255, 107, 53, 0.1);
            color: #ff6b35;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 0.8em;
            border: 1px solid rgba(255, 107, 53, 0.3);
        }
 
        .loading {
            text-align: center;
            color: #ff6b35;
            font-size: 1.2em;
            padding: 40px;
        }
 
        .coordinates {
            color: #aaa;
            font-size: 0.8em;
            margin-bottom: 10px;
        }
 
        .activity-high { border-left: 5px solid #ff4444; }
        .activity-moderate { border-left: 5px solid #ffaa44; }
        .activity-low { border-left: 5px solid #44ff44; }
 
        .statistics {
            background: rgba(42, 42, 42, 0.9);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-around;
            text-align: center;
        }
 
        .stat-item {
            color: #ff6b35;
        }
 
        .stat-number {
            font-size: 1.5em;
            font-weight: bold;
        }
 
        .image-management {
            background: rgba(42, 42, 42, 0.9);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            border: 2px solid #ff6b35;
        }
 
        .fetch-images-btn {
            background: linear-gradient(135deg, #ff6b35, #e55a2e);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);
            transition: all 0.3s ease;
        }
 
        .fetch-images-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 107, 53, 0.4);
        }
 
        .fetch-images-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .image-source-badge {
            display: inline-block;
            background: rgba(255, 107, 53, 0.2);
            color: #ff6b35;
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 0.7em;
            margin-top: 5px;
            border: 1px solid rgba(255, 107, 53, 0.3);
        }

        .legend {
            background: rgba(42, 42, 42, 0.9);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .legend-items {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 15px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #ccc;
            font-size: 0.9em;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 3px;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .activity-high-legend {
            background: #ff4444;
        }

        .activity-moderate-legend {
            background: #ffaa44;
        }

        .activity-low-legend {
            background: #44ff44;
        }
 
        @media (max-width: 768px) {
            .map-controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .generate-btn {
                margin-left: 0;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .locations-list {
                grid-template-columns: 1fr;
            }
 
            .statistics {
                flex-direction: column;
                gap: 10px;
            }

            .legend-items {
                flex-direction: column;
                align-items: center;
                gap: 10px;
            }

            .legend-item {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <img src="fulllogo_nobuffer.jpg" alt="Logo" class="header-logo">
            <div class="header-text">
                <h1>Haunt Map</h1>
                <p>Explore Haunted Places and Attractions with Stories.</p>
            </div>
        </div>
    </div>
 
    <div class="container">
        <div class="statistics">
            <div class="stat-item">
                <div class="stat-number" id="totalLocations">20</div>
                <div>Total Locations</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="highActivity">4</div>
                <div>High Activity</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="displayedCount">0</div>
                <div>Currently Displayed</div>
            </div>
        </div>

        <div class="legend">
            <h3 style="color: #ff6b35; margin-bottom: 15px; text-align: center;">Activity Level Legend</h3>
            <div class="legend-items">
                <div class="legend-item">
                    <div class="legend-color activity-low-legend"></div>
                    <span>Low Activity - Occasional phenomena</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color activity-moderate-legend"></div>
                    <span>Moderate Activity - Regular phenomena</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color activity-high-legend"></div>
                    <span>High Activity - Frequent encounters</span>
                </div>
            </div>
        </div>
 
        <div class="image-management">
            <h3 style="color: #ff6b35; margin-bottom: 15px;">Photo Gallery</h3>
            <button id="fetchImagesBtn" class="fetch-images-btn" onclick="updateHauntedSitesWithImages()">
                View Location Images
            </button>
            <p style="color: #ccc; font-size: 0.9em; margin-top: 10px;">
                
            </p>
            <div id="imageProgress" style="margin-top: 15px; color: #ff6b35; display: none;"></div>
        </div>
 
        <div class="map-controls">
            <div class="control-group">
                <label>State:</label>
                <select id="stateFilter">
                    <option value="" selected>All States</option>
                    <option value="AL">Alabama</option>
                    <option value="AK">Alaska</option>
                    <option value="AZ">Arizona</option>
                    <option value="AR">Arkansas</option>
                    <option value="CA">California</option>
                    <option value="CO">Colorado</option>
                    <option value="CT">Connecticut</option>
                    <option value="DE">Delaware</option>
                    <option value="DC">District of Columbia</option>
                    <option value="FL">Florida</option>
                    <option value="GA">Georgia</option>
                    <option value="HI">Hawaii</option>
                    <option value="ID">Idaho</option>
                    <option value="IL">Illinois</option>
                    <option value="IN">Indiana</option>
                    <option value="IA">Iowa</option>
                    <option value="KS">Kansas</option>
                    <option value="KY">Kentucky</option>
                    <option value="LA">Louisiana</option>
                    <option value="ME">Maine</option>
                    <option value="MD">Maryland</option>
                    <option value="MA">Massachusetts</option>
                    <option value="MI">Michigan</option>
                    <option value="MN">Minnesota</option>
                    <option value="MS">Mississippi</option>
                    <option value="MO">Missouri</option>
                    <option value="MT">Montana</option>
                    <option value="NB">Nebraska</option>
                    <option value="NH">New Hampshire</option>
                    <option value="NJ">New Jersey</option>
                    <option value="NM">New Mexico</option>
                    <option value="NY">New York</option>
                    <option value="NC">North Carolina</option>
                    <option value="ND">North Dakota</option>
                    <option value="OH">Ohio</option>
                    <option value="OK">Oklahoma</option>
                    <option value="OR">Oregon</option>
                    <option value="PA">Pennsylvania</option>
                    <option value="PR">Puerto Rico</option>
                    <option value="RI">Rhode Island</option>
                    <option value="SC">South Carolina</option>
                    <option value="SD">South Dakota</option>
                    <option value="TN">Tennessee</option>
                    <option value="TX">Texas</option>
                    <option value="UT">Utah</option>
                    <option value="VT">Vermont</option>
                    <option value="VA">Virginia</option>
                    <option value="WA">Washington</option>
                    <option value="WV">West Virginia</option>
                    <option value="WI">Wisconsin</option>
                    <option value="WY">Wyoming</option>
                </select>
            </div>
 
            <div class="control-group">
                <label>Location Type:</label>
                <select id="locationType">
                    <option value="">All Types</option>
                    <option value="Cemetery">Cemeteries</option>
                    <option value="Church">Churches</option>
                    <option value="College">Colleges</option>
                    <option value="Ghost Town">Ghost Towns</option>
                    <option value="Historic House">Historic Houses</option>
                    <option value="Hotel">Hotels</option>
                    <option value="Industrial Site">Industrial Sites</option>
                    <option value="Military Site">Military Sites</option>
                    <option value="Mining">Mining Sites</option>
                    <option value="Prison">Prisons</option>
                    <option value="Restaurant">Restaurants</option>
                    <option value="Saloon">Saloons</option>
                    <option value="Terrain">Terrain</option>                    
                    <option value="Theater">Theaters</option>
                </select>
            </div>
 
            <div class="control-group">
                <label>Activity Level:</label>
                <select id="activityLevel">
                    <option value="">All Levels</option>
                    <option value="low">Low Activity</option>
                    <option value="moderate">Moderate Activity</option>
                    <option value="high">High Activity</option>
                </select>
            </div>
 
            <div class="control-group">
                <label>Sort By:</label>
                <select id="sortOrder">
                    <option value="alphabetical">Alphabetical (A-Z)</option>
                    <option value="alphabetical-desc">Alphabetical (Z-A)</option>
                    <option value="activity">Activity Level</option>
                    <option value="year">Year Established</option>
                    <option value="type">Location Type</option>
                    <option value="city">City Name</option>
                </select>
            </div>
 
            <button class="generate-btn" onclick="filterAndDisplayLocations()">
                Apply Filters
            </button>
        </div>
 
        <div class="map-container">
            <div id="map"></div>
        </div>
 
        <div id="locationsList" class="locations-list">
            <!-- Generated locations will appear here -->
        </div>
    </div>
 
    <!-- Leaflet JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>
    
    <script>
        // === MULTI-SOURCE IMAGE FETCHER CODE ===
        class HauntedLocationImageFetcher {
            constructor() {
                this.cache = new Map();
                this.rateLimitDelay = 1200;
                
                // Public domain and free image sources
                this.imageSources = {
                    wikimedia: 'https://commons.wikimedia.org/w/api.php',
                    unsplash: 'https://api.unsplash.com/search/photos'
                };
                
                this.fallbackImages = {
                    "Cemetery": "https://images.unsplash.com/photo-1520500807606-fd6f5db4b18b?w=800&h=600&fit=crop",
                    "Church": "https://images.unsplash.com/photo-1569425409825-4b01c4b1d6c4?w=800&h=600&fit=crop", 
                    "College": "https://images.unsplash.com/photo-1503676260728-1c00da094a0b?w=800&h=600&fit=crop",
                    "Ghost Town": "https://images.unsplash.com/photo-1441260038675-7329ab4cc264?w=800&h=600&fit=crop",
                    "Historic House": "https://images.unsplash.com/photo-1520637836862-4d197d17c73a?w=800&h=600&fit=crop",
                    "Hotel": "https://images.unsplash.com/photo-1580587771525-78b9dba3b914?w=800&h=600&fit=crop",
                    "Industrial Site": "https://images.unsplash.com/photo-1518709268805-4e9042af2176?w=800&h=600&fit=crop",
                    "Military Site": "https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=800&h=600&fit=crop",
                    "Mining Site": "https://images.unsplash.com/photo-1446776877081-d282a0f896e2?w=800&h=600&fit=crop",
                    "Prison": "https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=800&h=600&fit=crop",
                    "Restaurant": "https://images.unsplash.com/photo-1564013799919-ab600027ffc6?w=800&h=600&fit=crop",
                    "Saloon": "https://images.unsplash.com/photo-1449824913935-59a10b8d2000?w=800&h=600&fit=crop",
                    "Terrain": "https://images.unsplash.com/photo-1439066615861-d1af74d74000?w=800&h=600&fit=crop",
                    "Theater": "https://images.unsplash.com/photo-1505142468610-359e7d316be0?w=800&h=600&fit=crop"
                };
            }
 
            createSearchQueries(site) {
                const { name, city, state, type, country = 'US' } = site;
                const cleanName = name.replace(/^The\s+/i, '').replace(/\s+(House|Hotel|Theater|Prison|Cemetery|Mansion)$/i, '');
                
                // Prioritize exact location matches first, then broader searches
                const queries = [
                    `"${name}" ${city} ${state}`,
                    `"${cleanName}" ${city}`,
                    `${name} ${state}`,
                    `${cleanName} ${city} ${country === 'UK' ? 'England' : state}`,
                    `${name.split(' ')[0]} ${type.toLowerCase()} ${city}`,
                    `historic ${type.toLowerCase()} ${city} ${state}`,
                ];
                
                // Add UK-specific searches
                if (country === 'UK') {
                    queries.push(
                        `${cleanName} England`,
                        `${cleanName} Britain UK`,
                        `${name} castle England`
                    );
                }
                
                return queries.filter(Boolean);
            }
 
            async searchWikimediaCommons(query) {
                try {
                    const searchUrl = `${this.imageSources.wikimedia}?action=query&format=json&list=search&srsearch=${encodeURIComponent(query + ' file:')}&srnamespace=6&srlimit=10&origin=*`;
                    
                    const response = await fetch(searchUrl);
                    const data = await response.json();
                    
                    if (data.query && data.query.search && data.query.search.length > 0) {
                        // Get the first result and fetch its image URL
                        const firstResult = data.query.search[0];
                        const imageInfoUrl = `${this.imageSources.wikimedia}?action=query&format=json&prop=imageinfo&iiprop=url|size&titles=${encodeURIComponent(firstResult.title)}&origin=*`;
                        
                        const imageResponse = await fetch(imageInfoUrl);
                        const imageData = await imageResponse.json();
                        
                        const pages = imageData.query?.pages;
                        if (pages) {
                            const page = Object.values(pages)[0];
                            if (page.imageinfo && page.imageinfo[0]) {
                                return {
                                    url: page.imageinfo[0].url,
                                    source: 'wikimedia',
                                    license: 'public domain'
                                };
                            }
                        }
                    }
                } catch (error) {
                    console.warn(`Wikimedia search failed for "${query}":`, error.message);
                }
                return null;
            }
 
            async searchUnsplash(query, apiKey) {
                if (!apiKey || apiKey === '3t7QkwquuCZ6faMM80mIMkrAQlybHcukcnrRADjhy_M') return null;
                
                try {
                    const response = await fetch(
                        `${this.imageSources.unsplash}?query=${encodeURIComponent(query)}&per_page=5&orientation=landscape`,
                        {
                            headers: {
                                'Authorization': `Client-ID ${apiKey}`
                            }
                        }
                    );
 
                    if (!response.ok) return null;
 
                    const data = await response.json();
                    if (data.results && data.results.length > 0) {
                        // Prioritize images with location names in description
                        const bestMatch = data.results.find(img => {
                            const desc = (img.description || '').toLowerCase();
                            const alt = (img.alt_description || '').toLowerCase();
                            return desc.includes(query.toLowerCase().split(' ')[0]) || 
                                   alt.includes(query.toLowerCase().split(' ')[0]);
                        }) || data.results[0];
                        
                        return {
                            url: bestMatch.urls.regular,
                            source: 'unsplash',
                            license: 'unsplash license'
                        };
                    }
                } catch (error) {
                    console.warn(`Unsplash search failed for "${query}":`, error.message);
                }
                return null;
            }
 
            async getImageForLocation(site, apiKeys = {}) {
                const cacheKey = `${site.name}-${site.city}-${site.state}`;
                
                if (this.cache.has(cacheKey)) {
                    return this.cache.get(cacheKey);
                }
 
                const queries = this.createSearchQueries(site);
                
                for (const query of queries) {
                    console.log(`Searching for: "${query}" (${site.name})`);
                    
                    // Try Wikimedia Commons first (public domain)
                    let result = await this.searchWikimediaCommons(query);
                    if (result) {
                        console.log(`✓ Found Wikimedia image for ${site.name}`);
                        this.cache.set(cacheKey, result);
                        return result;
                    }
                    
                    await this.delay(800);
                    
                    // Try Unsplash as secondary source
                    result = await this.searchUnsplash(query, apiKeys.unsplash);
                    if (result) {
                        console.log(`✓ Found Unsplash image for ${site.name}`);
                        this.cache.set(cacheKey, result);
                        return result;
                    }
                    
                    await this.delay(this.rateLimitDelay);
                }
                
                // Use fallback if no results found
                const fallbackUrl = this.fallbackImages[site.type] || this.fallbackImages["Historic House"];
                const fallbackResult = {
                    url: fallbackUrl,
                    source: 'fallback',
                    license: 'unsplash'
                };
                
                console.log(`Using fallback for ${site.name}`);
                this.cache.set(cacheKey, fallbackResult);
                return fallbackResult;
            }
 
            async processAllLocations(sites, progressCallback, apiKeys = {}) {
                const updatedSites = [];
                console.log(`Processing ${sites.length} haunted locations...`);
                
                for (let i = 0; i < sites.length; i++) {
                    const site = sites[i];
                    
                    try {
                        if (progressCallback) {
                            progressCallback(i + 1, sites.length, site.name);
                        }
                        
                        const imageResult = await this.getImageForLocation(site, apiKeys);
                        
                        updatedSites.push({
                            ...site,
                            imageUrl: imageResult.url,
                            imageSource: imageResult.source,
                            imageLicense: imageResult.license
                        });
                        
                    } catch (error) {
                        console.error(`Error processing ${site.name}:`, error);
                        
                        updatedSites.push({
                            ...site,
                            imageUrl: this.fallbackImages[site.type] || this.fallbackImages["Historic House"],
                            imageSource: 'fallback',
                            imageLicense: 'unsplash'
                        });
                    }
                }
                
                return updatedSites;
            }
 
            delay(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }
        }

        // Function to update haunted locations with authentic images
        async function updateHauntedSitesWithImages() {
            const apiKeys = {
                unsplash: '3t7QkwquuCZ6faMM80mIMkrAQlybHcukcnrRADjhy_M'
            };
            
            const fetcher = new HauntedLocationImageFetcher();
            const progressDiv = document.getElementById('imageProgress');
            const button = document.getElementById('fetchImagesBtn');
            
            try {
                button.disabled = true;
                button.textContent = '🔄 Fetching Authentic Location Images...';
                progressDiv.style.display = 'block';
                progressDiv.textContent = 'Searching for photos of haunted locations...';
                
                console.log('Starting image search process...');
                
                const updatedSites = await fetcher.processAllLocations(hauntedLocations, (current, total, siteName) => {
                    progressDiv.textContent = `Processing ${current}/${total}: ${siteName}`;
                }, apiKeys);
                
                // Replace the original array with updated images
                hauntedLocations.length = 0;
                hauntedLocations.push(...updatedSites);
                
                console.log('✓ Authentic image search complete! Refreshing display...');
                progressDiv.textContent = '✓ Authentic images loaded! Refreshing display...';
                
                // Refresh the display with new images
                filterAndDisplayLocations();
                
                setTimeout(() => {
                    progressDiv.style.display = 'none';
                    button.disabled = false;
                    button.textContent = '✓ Authentic Images Updated Successfully!';
                    
                    setTimeout(() => {
                        button.textContent = 'View Location Images';
                    }, 3000);
                }, 2000);
                
            } catch (error) {
                console.error('Error updating images:', error);
                progressDiv.textContent = '❌ Error fetching images. Check console for details.';
                button.disabled = false;
                button.textContent = 'View Location Images';
            }
        }
        // === END MULTI-SOURCE IMAGE FETCHER CODE ===
 
        // Initialize the map - Center on US initially
        let map = L.map('map').setView([39.8283, -98.5795], 4);

        // Primary tile layer - CartoDB Dark Matter
        const primaryTiles = L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
            subdomains: 'abcd',
            maxZoom: 19
        });

        // Fallback tile layer - OpenStreetMap
        const fallbackTiles = L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
            maxZoom: 19
        });

        // Secondary fallback - Different CartoDB endpoint
        const secondaryTiles = L.tileLayer('https://cartodb-basemaps-{s}.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
            subdomains: 'abcd',
            maxZoom: 19
        });

        // Try to add primary tiles first
        let currentTileLayer = primaryTiles;
        currentTileLayer.addTo(map);

        // Enhanced error handling for tile loading
        let tileErrorCount = 0;
        map.on('tileerror', function(error) {
            console.log('Tile loading error:', error);
            tileErrorCount++;
            
            // If we get multiple tile errors, switch to fallback
            if (tileErrorCount > 3) {
                console.log('Switching to fallback tiles...');
                map.removeLayer(currentTileLayer);
                
                // Try secondary tiles first, then fallback to OSM
                if (currentTileLayer === primaryTiles) {
                    currentTileLayer = secondaryTiles;
                    currentTileLayer.addTo(map);
                } else if (currentTileLayer === secondaryTiles) {
                    currentTileLayer = fallbackTiles;
                    currentTileLayer.addTo(map);
                }
                
                tileErrorCount = 0; // Reset counter
            }
        });

        // Force refresh tiles if still gray after 5 seconds
        setTimeout(() => {
            if (tileErrorCount > 0) {
                console.log('Force switching to OpenStreetMap tiles...');
                map.removeLayer(currentTileLayer);
                currentTileLayer = fallbackTiles;
                currentTileLayer.addTo(map);
            }
        }, 5000);
 
        // Store markers for clearing
        let markersGroup = L.layerGroup().addTo(map);
 
        // Haunted locations database
        const hauntedLocations = [
            {
                id: "al001",
                state: "AL",
                name: "Sloss Furnaces",
                city: "Birmingham",
                coordinates: [33.5186, -86.8025],
                story: "Former iron-producing facility where harsh working conditions led to numerous fatal accidents. James 'Slag' Wormwood, a brutal foreman, pushed workers to dangerous limits until 47 died under his watch. Visitors report being pushed by invisible hands, hearing disembodied voices, and experiencing extreme temperature drops in certain areas of the facility.",
                features: ["Disembodied Voices", "Physical Pushing", "Apparitions", "Extreme Cold Spots"],
                activityLevel: "high",
                yearEstablished: 1882,
                type: "Industrial Site"
            },
            {
                id: "al002",
                state: "AL",
                name: "The Drish House",
                city: "Tuscaloosa",
                coordinates: [33.2098, -87.5692],
                story: "Antebellum mansion where Dr. John R. Drish died from a drunken fall in 1867. His widow Sarah became obsessed with preserving his funeral candles, lighting them nightly in the windows. When she died, the candles mysteriously continued to burn, visible from the street even when the house was empty.",
                features: ["Phantom Fires", "Ghostly Lights", "Apparitions", "Cold Spots"],
                activityLevel: "high",
                yearEstablished: 1837,
                type: "Historic House"
            },
            {
                id: "al003",
                state: "AL",
                name: "Dead Children's Playground",
                city: "Huntsville",
                coordinates: [34.7304, -86.5861],
                story: "Playground within Maple Hill Cemetery where children who died during the 1918 Spanish flu epidemic are buried. The swings move on windless nights, and visitors hear the sound of children's laughter echoing through the darkness.",
                features: ["Self-Moving Swings", "Children's Laughter", "Orbs in Photos", "Disembodied Voices"],
                activityLevel: "high",
                yearEstablished: 1822,
                type: "Cemetery"
            },
            {
                id: "al004",
                state: "AL",
                name: "Old Cahawba Archaeological Park",
                city: "Orrville",
                coordinates: [32.3115, -87.1058],
                story: "Alabama's first state capital, abandoned after repeated flooding. Once home to over 3,000 people, now only ruins remain. Visitors report seeing figures in period clothing walking the old streets and hearing the sounds of a bustling town that no longer exists.",
                features: ["Period Apparitions", "Phantom Sounds", "Shadow Figures", "EMF Spikes"],
                activityLevel: "moderate",
                yearEstablished: 1819,
                type: "Ghost Town"
            },
            {
                id: "al005",
                state: "AL",
                name: "Fort Morgan",
                city: "Gulf Shores",
                coordinates: [30.2299, -88.0208],
                story: "Civil War fortress where Confederate soldiers made their last stand. The fort's dark history includes prisoner deaths, battle casualties, and yellow fever outbreaks. Visitors report seeing soldiers in uniform patrolling the ramparts at night.",
                features: ["Soldier Apparitions", "Cannon Fire Sounds", "Cold Spots", "Electronic Malfunctions"],
                activityLevel: "moderate",
                yearEstablished: 1834,
                type: "Military Site"
            },
            {
                id: "al006",
                state: "AL",
                name: "Gaineswood Mansion",
                city: "Demopolis",
                coordinates: [32.5176, -87.8364],
                story: "Greek Revival mansion built by Nathan Bryan Whitfield, who died during construction in 1860. His spirit allegedly remains to oversee the completion of his masterpiece. Staff report doors opening and closing, piano music from empty rooms, and the scent of his favorite tobacco.",
                features: ["Piano Music", "Tobacco Scent", "Moving Doors", "Apparitions"],
                activityLevel: "moderate",
                yearEstablished: 1843,
                type: "Historic House"
            },
            {
                id: "al007",
                state: "AL",
                name: "Pickens County Courthouse",
                city: "Carrollton",
                coordinates: [33.2618, -88.0953],
                story: "The courthouse window displays a mysterious face burned into the glass - allegedly that of Henry Wells, a man accused of arson who was lynched before trial. He proclaimed his innocence and said his face would appear as proof. The face has remained visible for over 100 years.",
                features: ["Mysterious Face in Window", "Cold Spots", "Unexplained Sounds", "Camera Malfunctions"],
                activityLevel: "moderate",
                yearEstablished: 1877,
                type: "Historic House"
            },
            {
                id: "al008",
                state: "AL",
                name: "USS Alabama Battleship",
                city: "Mobile",
                coordinates: [30.6818, -88.0146],
                story: "WWII battleship now serving as a museum. During its service, several sailors died aboard the ship. Visitors and staff report phantom footsteps on metal decks, voices over the intercom system, and figures in naval uniforms walking the corridors.",
                features: ["Phantom Footsteps", "Intercom Voices", "Naval Apparitions", "Equipment Malfunctions"],
                activityLevel: "moderate",
                yearEstablished: 1942,
                type: "Military Site"
            },
            {
                id: "al009",
                state: "AL",
                name: "Riverside Cemetery",
                city: "Ashland",
                coordinates: [33.2732, -85.8358],
                story: "Small town cemetery where numerous Civil War soldiers are buried. Local legends speak of a weeping woman in black who visits graves on moonless nights. Visitors report seeing glowing orbs, hearing sobbing, and feeling an overwhelming sense of sadness.",
                features: ["Weeping Woman", "Glowing Orbs", "Overwhelming Sadness", "Phantom Sobbing"],
                activityLevel: "moderate",
                yearEstablished: 1845,
                type: "Cemetery"
            },
            {
                id: "al010",
                state: "AL",
                name: "Historic Huntsville Depot",
                city: "Huntsville",
                coordinates: [34.7280, -86.5861],
                story: "Built in 1860, this railroad depot served as a prison during the Civil War. Union soldiers held Confederate prisoners here in terrible conditions. Visitors report hearing the sounds of trains that no longer run and seeing figures in period military uniforms.",
                features: ["Phantom Train Sounds", "Military Apparitions", "Cold Spots", "Unexplained Voices"],
                activityLevel: "moderate",
                yearEstablished: 1860,
                type: "Historic House"
            },
            {
                id: "al011",
                state: "AL",
                name: "Bellingrath Gardens Ghost",
                city: "Theodore",
                coordinates: [30.5524, -88.1617],
                story: "Beautiful 65-acre garden where Bessie Bellingrath's spirit is said to still tend her beloved flowers. Gardeners report tools moving on their own, flowers blooming out of season, and a gentle presence guiding their work.",
                features: ["Moving Garden Tools", "Out-of-Season Blooms", "Gentle Presence", "Floral Scents"],
                activityLevel: "low",
                yearEstablished: 1932,
                type: "Historic House"
            },
            {
                id: "al012",
                state: "AL",
                name: "Blount County Memorial Museum",
                city: "Oneonta",
                coordinates: [33.9482, -86.4725],
                story: "Former schoolhouse turned museum where the spirit of a dedicated teacher allegedly remains. Visitors report chalk writing appearing on blackboards, books falling from shelves, and the sound of children reciting lessons in empty classrooms.",
                features: ["Phantom Writing", "Falling Books", "Children's Voices", "Classroom Sounds"],
                activityLevel: "low",
                yearEstablished: 1907,
                type: "Historic House"
            },
            {
                id: "al013",
                state: "AL",
                name: "Noccalula Falls",
                city: "Gadsden",
                coordinates: [34.0212, -86.0219],
                story: "Legend tells of Noccalula, a Cherokee princess who jumped to her death rather than marry against her will. Visitors report seeing a woman in white near the falls, feeling sudden sadness, and hearing mournful singing carried on the wind.",
                features: ["Woman in White", "Sudden Sadness", "Mournful Singing", "Temperature Drops"],
                activityLevel: "low",
                yearEstablished: 1800,
                type: "Terrain"
            },
            {
                id: "al014",
                state: "AL",
                name: "Ave Maria Grotto",
                city: "Cullman",
                coordinates: [34.1848, -86.8436],
                story: "Miniature Jerusalem built by Brother Joseph Zoettl. Some visitors report seeing a monk-like figure tending to the tiny buildings and experiencing an overwhelming sense of peace and spiritual presence among the grottos.",
                features: ["Monk Apparition", "Spiritual Presence", "Peaceful Energy", "Moving Shadows"],
                activityLevel: "low",
                yearEstablished: 1934,
                type: "Church"
            },
            {
                id: "al015",
                state: "AL",
                name: "Shorter Mansion",
                city: "Eufaula",
                coordinates: [31.8915, -85.1455],
                story: "Neoclassical mansion where Eli Shorter II died in 1906. His widow reported seeing him in his favorite chair reading the newspaper each morning. Current staff and visitors continue to report sightings of a distinguished gentleman in the parlor.",
                features: ["Gentleman Apparition", "Moving Newspapers", "Phantom Reading", "Cigar Smoke Scent"],
                activityLevel: "low",
                yearEstablished: 1884,
                type: "Historic House"
            },
            {
                id: "al016",
                state: "AL",
                name: "Oakleigh Mansion",
                city: "Mobile",
                coordinates: [30.6977, -88.0567],
                story: "Greek Revival mansion where the Irwin family lived for generations. Visitors report seeing a woman in a blue dress gliding through the halls, believed to be one of the Irwin daughters who died young. The scent of magnolias often accompanies her presence.",
                features: ["Woman in Blue Dress", "Magnolia Scent", "Gliding Apparition", "Piano Music"],
                activityLevel: "moderate",
                yearEstablished: 1833,
                type: "Historic House"
            },
            {
                id: "al017",
                state: "AL",
                name: "Redstone Arsenal",
                city: "Huntsville",
                coordinates: [34.6834, -86.6503],
                story: "Former WWII chemical weapons manufacturing site and current rocket development facility. Security guards report unexplained lights in abandoned buildings, strange odors that medical tests cannot identify, and equipment that operates on its own.",
                features: ["Unexplained Lights", "Strange Odors", "Equipment Malfunctions", "Security Alerts"],
                activityLevel: "moderate",
                yearEstablished: 1941,
                type: "Military Site"
            },
            {
                id: "al018",
                state: "AL",
                name: "Lotz House Museum",
                city: "Franklin",
                coordinates: [35.9251, -86.8689],
                story: "Civil War era house that served as a Confederate hospital. The Lotz family reported paranormal activity for generations, including soldiers appearing in bedrooms, medical equipment moving, and the sounds of surgery being performed.",
                features: ["Soldier Apparitions", "Medical Sounds", "Moving Equipment", "Phantom Surgery"],
                activityLevel: "high",
                yearEstablished: 1858,
                type: "Historic House"
            },
            {
                id: "al019",
                state: "AL",
                name: "Bottle Tree Ranch",
                city: "Millerville",
                coordinates: [32.8751, -85.7816],
                story: "Art installation of bottle trees based on African American folk tradition. According to legend, the bottles trap evil spirits. Visitors report unusual electromagnetic readings, mysterious lights within the bottles at night, and an eerie silence that falls over the area.",
                features: ["Trapped Spirit Energy", "Bottle Lights", "EMF Anomalies", "Unnatural Silence"],
                activityLevel: "low",
                yearEstablished: 1990,
                type: "Terrain"
            },
            {
                id: "al020",
                state: "AL",
                name: "St. Elmo Historic District",
                city: "Mobile",
                coordinates: [30.6504, -88.1137],
                story: "Historic neighborhood where numerous antebellum homes are said to be haunted. Residents report seeing carriages that cast no shadows, hearing horse hooves on modern pavement, and witnessing figures in period dress walking the streets after midnight.",
                features: ["Phantom Carriages", "Horse Hoof Sounds", "Period Apparitions", "Shadow Figures"],
                activityLevel: "moderate",
                yearEstablished: 1840,
                type: "Historic House"
            },
            {
                id: "al021",
                state: "AL",
                name: "Oak Hill Cemetery",
                city: "Birmingham",
                coordinates: [33.5186, -86.8025],
                story: "Located in Birmingham with a stunning view of the city skyline, this historic cemetery houses the grave of John T. Milner, the railroad engineer whose projects paved the way for Birmingham's development. The cemetery is home to the mysterious Erswell Vault, where visitors report hearing whispers and mutterings from Catherine Erswell.",
                features: ["Vault Whispers", "City Builder Spirits", "Mutterings from Tombs", "Railroad Pioneer Ghost"],
                activityLevel: "moderate",
                yearEstablished: 1869,
                type: "Cemetery"
            },
            {
                id: "al022",
                state: "AL",
                name: "Clearwater Cemetery",
                city: "Wagarville",
                coordinates: [31.3182, -87.0350],
                story: "This cemetery is haunted by a ghostly white lady who appears on the dirt road outside the gates between midnight and 3 AM. Local legend tells of an unidentified woman who was brutally assaulted and murdered either in the cemetery or on the road many years ago. Her restless spirit now appears to travelers seeking justice.",
                features: ["White Lady Apparition", "Midnight to 3AM Activity", "Murder Victim Spirit", "Road Hauntings"],
                activityLevel: "high",
                yearEstablished: 1800,
                type: "Cemetery"
            },
            {
                id: "al023",
                state: "AL",
                name: "Hodges Cemetery",
                city: "Gardendale",
                coordinates: [33.6551, -86.8119],
                story: "This remote cemetery is notorious for terrorizing motorists who pass by. Drivers report objects banging against their cars, ghostly hands or faces appearing on windows, and being chased by a wolf with glowing red eyes accompanied by a mysterious glowing light. Shadowy figures dart between tombstones.",
                features: ["Vehicle Harassment", "Glowing Red-Eyed Wolf", "Moving Tombstones", "Shadow Figure Activity"],
                activityLevel: "high",
                yearEstablished: 1850,
                type: "Cemetery"
            },
            {
                id: "al024",
                state: "AL",
                name: "Gallant Children's Cemetery",
                city: "Gallant",
                coordinates: [34.1184, -86.2011],
                story: "This small cemetery is dedicated to children and is said to be haunted by friendly child spirits who come out to play with each other late at night. Despite their cheerful nature, visitors report having their hair pulled, experiencing sudden sickness, and being pushed by invisible hands.",
                features: ["Friendly Child Spirits", "Physical Interactions", "Tree Face Manifestations", "Nighttime Playfulness"],
                activityLevel: "moderate",
                yearEstablished: 1890,
                type: "Cemetery"
            },
            {
                id: "al025",
                state: "AL",
                name: "Cardiff Cemetery",
                city: "Graysville",
                coordinates: [33.6198, -86.9661],
                story: "Located in Graysville, this cemetery is known for its mysterious orbs and strange lights that appear throughout the graveyard with no traceable source. The cemetery has gained a peculiar reputation for automotive interference - cars may stop dead on Friday the 13th and have trouble starting for five minutes.",
                features: ["Mysterious Orbs", "Friday the 13th Car Trouble", "Strange Lights", "Automotive Interference"],
                activityLevel: "moderate",
                yearEstablished: 1880,
                type: "Cemetery"
            },
            {
                id: "al026",
                state: "AL",
                name: "Cooley Cemetery",
                city: "Anniston",
                coordinates: [33.6597, -85.8316],
                story: "Located on Brindle Mountain near Manchester Drive, this off-the-beaten-path cemetery dates back to the Civil War era. The cemetery experiences supernatural mist phenomena where a mysterious fog will cover only the tombstones while leaving the surrounding woodlands completely clear.",
                features: ["Selective Supernatural Mist", "Cold Breezes", "Unmarked Grave Spirits", "Mountain Isolation"],
                activityLevel: "moderate",
                yearEstablished: 1865,
                type: "Cemetery"
            },
            {
                id: "al027",
                state: "AL",
                name: "Harper Hill Church & Cemetery",
                city: "Dadeville",
                coordinates: [32.8301, -85.7635],
                story: "This abandoned and deteriorating site has been left to decay for many years, but its former residents refuse to rest peacefully. Local legend tells of a minister who went utterly insane over a century ago and murdered his entire family before taking his own life within the church walls.",
                features: ["Family Murder Spirits", "Abandoned Church Hauntings", "Insane Minister Ghost", "Deteriorating Sacred Ground"],
                activityLevel: "high",
                yearEstablished: 1870,
                type: "Cemetery"
            },
            {
                id: "al028",
                state: "AL",
                name: "Easly Cemetery",
                city: "Jasper",
                coordinates: [33.8312, -87.2775],
                story: "This cemetery is known for its aggressive supernatural phenomena that manifest primarily at night. Visitors commonly encounter a fiery red orb that floats through the graveyard and has been known to chase people who venture too close. A white phantom figure has also been spotted on the adjacent road.",
                features: ["Chasing Fire Orbs", "White Phantom Figure", "Visitor Illness", "Screaming Sounds"],
                activityLevel: "high",
                yearEstablished: 1885,
                type: "Cemetery"
            },
            {
                id: "al029",
                state: "AL",
                name: "New Providence Cemetery",
                city: "Coy",
                coordinates: [32.2879, -86.3658],
                story: "Also known as Coy Cemetery, this burial ground serves as the final resting place for many prominent African Americans from the area's history. The cemetery is illuminated by mysterious lights that glow above the graves with no traceable earthly source, creating an otherworldly atmosphere.",
                features: ["Mysterious Grave Lights", "Disembodied Voices", "African American History", "Untraceable Light Sources"],
                activityLevel: "moderate",
                yearEstablished: 1870,
                type: "Cemetery"
            },
            {
                id: "al030",
                state: "AL",
                name: "Cemetery Mountain",
                city: "Munford",
                coordinates: [33.5329, -85.9497],
                story: "Located in Munford, this aptly named location features scattered graves across a mountain. Local tales speak of an old abandoned church somewhere on the mountain containing a pedestal bearing a single book. Legend claims the book can be lifted but becomes impossibly heavy as you approach the church door.",
                features: ["Scattered Mountain Graves", "Mysterious Heavy Book", "Abandoned Church", "Supernatural Weight Phenomena"],
                activityLevel: "moderate",
                yearEstablished: 1860,
                type: "Cemetery"
            },
            {
                id: "al031",
                state: "AL",
                name: "Little Vine Cemetery",
                city: "Empire",
                coordinates: [33.8184, -86.8119],
                story: "This small cemetery near the Little Vine Church possesses a simple but persistent supernatural phenomenon. A faint green light appears above the gravestones during the night hours, visible to motorists driving past the cemetery. The consistent nature of the green light sightings has earned it recognition.",
                features: ["Faint Green Light", "Nighttime Manifestations", "Roadside Sightings", "Consistent Phenomena"],
                activityLevel: "low",
                yearEstablished: 1875,
                type: "Cemetery"
            },
            {
                id: "al032",
                state: "AL",
                name: "Consolation Church Cemetery",
                city: "Red Level",
                coordinates: [31.4054, -86.6208],
                story: "This abandoned church and cemetery complex was left to deteriorate for years before the church building was destroyed by fire in 2015. During its abandonment, visitors reported Confederate soldiers, ghostly children, and a shrieking banshee. Most terrifying were sightings of hellhounds with glowing red eyes.",
                features: ["Confederate Soldier Spirits", "Ghostly Children", "Shrieking Banshee", "Hellhounds with Red Eyes"],
                activityLevel: "high",
                yearEstablished: 1850,
                type: "Cemetery"
            },
            {
                id: "al033",
                state: "AL",
                name: "Village Falls Cemetery",
                city: "Birmingham",
                coordinates: [33.4734, -86.8074],
                story: "This Birmingham-area cemetery has gained attention from paranormal investigators and visitors who report hearing unknown voices while walking among the graves. The disembodied voices seem to engage visitors in conversation, though the words are often unclear or fragmented.",
                features: ["Unknown Voices", "Disembodied Conversations", "Multiple Spirit Activity", "Vocal Manifestations"],
                activityLevel: "moderate",
                yearEstablished: 1890,
                type: "Cemetery"
            },
            {
                id: "al034",
                state: "AL",
                name: "Bladon Springs Cemetery",
                city: "Bladon Springs",
                coordinates: [31.6790, -88.1119],
                story: "Located near the Tombigbee River, this cemetery holds the tragic story of the steamboat James T. Staples disaster of 1913. Twenty-six souls died when the ship exploded and sank. Captain Norman Staples, who had lost the ship to creditors and committed suicide, is buried here. His sad spirit patrols the grounds.",
                features: ["Steamboat Disaster Spirits", "Captain's Eternal Vigil", "River Tragedy Ghosts", "Multiple Family Deaths"],
                activityLevel: "moderate",
                yearEstablished: 1900,
                type: "Cemetery"
            },
            {
                id: "al035",
                state: "AL",
                name: "Pine Hill Cemetery",
                city: "Auburn",
                coordinates: [32.6099, -85.4808],
                story: "This cemetery was established in 1863 close to a Confederate hospital relocated from Vicksburg, Mississippi after the city's fall during the Civil War. Most graves belong to Confederate soldiers, though tradition holds that unmarked graves beyond the back fence contain Union soldiers.",
                features: ["Civil War Hospital Spirits", "Union and Confederate Ghosts", "Full Apparitions", "Physical Contact from Spirits"],
                activityLevel: "moderate",
                yearEstablished: 1863,
                type: "Cemetery"
            },
                {
        id: "ak001",
        state: "AK",
        name: "Historic Anchorage Hotel",
        city: "Anchorage",
        coordinates: [61.2181, -149.9003],
        story: "Listed on the National Register of Historic Places, this historic hotel has been a hotbed of paranormal activity since its construction in 1916. The most infamous spirit is Police Chief Jack Sturgus, murdered just outside the hotel in 1921. Guests report a woman in a wedding dress roaming the second floor, believed to be a jilted bride who never checked out. The hotel staff maintains a 'ghost log' where nearly three dozen spirits have been documented.",
        features: ["Jilted Bride Apparition", "Police Chief Ghost", "Moving Objects", "Ghost Log Documentation"],
        activityLevel: "high",
        yearEstablished: 1916,
        type: "Hotel"
    },
    {
        id: "ak002",
        state: "AK",
        name: "Red Onion Saloon",
        city: "Skagway",
        coordinates: [59.4600, -135.3100],
        story: "This former brothel from the Gold Rush era is haunted by several spirits, most notably Lydia, a former prostitute who still watches over the upstairs quarters she once ran. Paranormal investigators have documented unexplained cold spots near her old room, and the scent of perfume drifts through the air. Diamond Lil, a former madam, also haunts the establishment along with an angry male entity who shows particular hostility toward men.",
        features: ["Brothel Madam Spirit", "Phantom Perfume Scents", "Cold Spots", "Hostile Male Entity"],
        activityLevel: "high",
        yearEstablished: 1898,
        type: "Saloon"
    },
    {
        id: "ak003",
        state: "AK",
        name: "Golden North Hotel",
        city: "Skagway",
        coordinates: [59.4594, -135.3106],
        story: "Built in 1898 and later moved to its current location in 1908, this onion-domed hotel is haunted by Mary, a woman who lived in Room 23 with her fiancé Ike during the Gold Rush. Mary died of illness while Ike was away prospecting for gold. She is seen wandering the halls and looking out of the window of Room 23, forever waiting for her love to return from the goldfields.",
        features: ["Gold Rush Era Spirit", "Room 23 Hauntings", "Window Apparitions", "Tragic Love Story"],
        activityLevel: "moderate",
        yearEstablished: 1898,
        type: "Hotel"
    },
    {
        id: "ak004",
        state: "AK",
        name: "Alaskan Hotel",
        city: "Juneau",
        coordinates: [58.3019, -134.4197],
        story: "Alaska's oldest operating hotel, established in 1913, served as a bar, café, speakeasy, and brothel during its colorful history. The hotel is haunted by several spirits including a miner, a bride who was a prostitute murdered by her husband, and a child. Rooms 218, 219, 315, and 321 are particularly active. A man was found dead in room 219 as recently as 2017, adding to the hotel's supernatural legacy.",
        features: ["Multiple Spirits", "Murdered Bride Ghost", "Child Apparition", "Active Hotel Rooms"],
        activityLevel: "high",
        yearEstablished: 1913,
        type: "Hotel"
    },
    {
        id: "ak005",
        state: "AK",
        name: "Snow City Cafe",
        city: "Anchorage",
        coordinates: [61.2175, -149.8958],
        story: "Since 1998, this café has been haunted by Muriel Pfiel, who owned the first travel agency in Anchorage where the café now stands. On September 30, 1976, Pfiel was killed instantly by a car bomb planted by her ex-husband, a wealthy lawyer. She was the victim of Alaska's only car bombing. Her playful spirit continues to interact with patrons and staff, making her presence known through unexplained phenomena.",
        features: ["Car Bomb Victim Spirit", "Playful Ghost Activity", "Historical Murder Site", "Travel Agency Connection"],
        activityLevel: "moderate",
        yearEstablished: 1976,
        type: "Restaurant"
    },
    {
        id: "ak006",
        state: "AK",
        name: "Wendy Williamson Auditorium",
        city: "Anchorage",
        coordinates: [61.1919, -149.8272],
        story: "Built over 40 years ago at the University of Alaska Anchorage, this auditorium is haunted by John Williamson, who despises his portrait that used to hang in the lobby. Every time the portrait was hung, it would be found on the ground the next day. An angry male spirit pushes women with long brown hair, and a woman in white has appeared during performances, initially mistaken as part of the show.",
        features: ["Portrait Poltergeist", "Gender-Specific Harassment", "Performance Interruptions", "University Haunting"],
        activityLevel: "moderate",
        yearEstablished: 1973,
        type: "Auditorium"
    },
    {
        id: "ak007",
        state: "AK",
        name: "Hotel Captain Cook",
        city: "Anchorage",
        coordinates: [61.2181, -149.8908],
        story: "Built in 1965 following the devastating 1964 earthquake, this luxury hotel is haunted by a young woman who committed suicide in the lobby restroom in 1972. She appears as a woman dressed in white and is most often seen in the women's restroom. The paranormal activity may be connected to the traumatic earthquake that destroyed much of Anchorage, leaving spiritual imprints throughout the area.",
        features: ["Suicide Victim Spirit", "Restroom Apparitions", "Earthquake-Related Activity", "White Lady Sightings"],
        activityLevel: "moderate",
        yearEstablished: 1965,
        type: "Hotel"
    },
    {
        id: "ak008",
        state: "AK",
        name: "4th Avenue Theatre",
        city: "Anchorage",
        coordinates: [61.2181, -149.8947],
        story: "Completed in 1947 after World War II, this glamorous 960-seat theater operated until the 1980s. During the 1964 earthquake, 131 people died in the area while the theater was on lockdown. The theater is haunted by a woman whose ghostly figure appears in reflections of the long mirrors between the restrooms. She may be a lost soul from the earthquake disaster that devastated Anchorage.",
        features: ["Earthquake Victim Spirit", "Mirror Apparitions", "Historical Theater Ghost", "Natural Disaster Connection"],
        activityLevel: "moderate",
        yearEstablished: 1947,
        type: "Theater"
    },
    {
        id: "ak009",
        state: "AK",
        name: "Begich Towers",
        city: "Whittier",
        coordinates: [60.7744, -148.6831],
        story: "This 14-story condominium was built during the Cold War era for military purposes and now houses nearly all of Whittier's population. The building includes schools, churches, and shops, making it a city within a building. Residents report seeing apparitions wandering the hallways, hearing unexplained footsteps and whispers, and experiencing sudden extreme temperature changes. The military history and isolated nature contribute to its haunted reputation.",
        features: ["Military Apparitions", "Unexplained Footsteps", "Temperature Fluctuations", "Isolated Community Spirits"],
        activityLevel: "high",
        yearEstablished: 1950,
        type: "Military Building"
    },
    {
        id: "ak010",
        state: "AK",
        name: "Inlet Tower Hotel & Suites",
        city: "Anchorage",
        coordinates: [61.2189, -149.8939],
        story: "This hotel has quite a reputation for eerie experiences and is considered one of Alaska's most haunted places. Guests report seeing the ghost of a little girl in the hallways and a male apparition in the elevator. The 9th floor is particularly active, with guests reporting lamps turning on by themselves within minutes of entering their rooms. Visitors describe the air getting thicker and an overwhelming sense of being watched.",
        features: ["Child Apparition", "Elevator Ghost", "9th Floor Activity", "Atmospheric Changes"],
        activityLevel: "high",
        yearEstablished: 1985,
        type: "Hotel"
    },
    {
        id: "ak011",
        state: "AK",
        name: "Kennecott Ghost Town",
        city: "McCarthy",
        coordinates: [61.4983, -142.8869],
        story: "Once the world's richest copper mine, Kennecott was established in 1903 and abandoned in 1938 when copper prices fell during the Great Depression. Legend says miners dropped their tools where they stood and left on the last train, never to return. The 14-story mill building and numerous structures remain, with visitors reporting ghostly miners still working the abandoned equipment and phantom sounds of machinery operating in the empty buildings.",
        features: ["Phantom Miners", "Machinery Sounds", "Abandoned Buildings", "Industrial Spirits"],
        activityLevel: "moderate",
        yearEstablished: 1903,
        type: "Ghost Town"
    },
    {
        id: "ak012",
        state: "AK",
        name: "Fort Richardson",
        city: "Anchorage",
        coordinates: [61.2653, -149.6644],
        story: "This military base near Anchorage has a rich history of paranormal tales involving ghostly soldiers seen patrolling the grounds. Numerous stories circulate about mysterious sounds in abandoned buildings and unexplained phenomena experienced by military personnel. The historic relevance of this site, combined with decades of military activity and potential combat training fatalities, fuels the legends that attract ghost hunters.",
        features: ["Military Patrol Spirits", "Abandoned Building Sounds", "Soldier Apparitions", "Military Base Activity"],
        activityLevel: "moderate",
        yearEstablished: 1940,
        type: "Military Base"
    },
    {
        id: "ak013",
        state: "AK",
        name: "Eklutna Cemetery",
        city: "Eklutna",
        coordinates: [61.4714, -149.3542],
        story: "This burial ground near Anchorage is shrouded in mystique and local folklore. The 'Spirit Houses' found at this cemetery are believed to be shelters for the spirits of the deceased, constructed in the Dena'ina Athabascan tradition. Visitors recount eerie encounters, feeling strong presences and witnessing unexplained phenomena attributed to the resting spirits who continue to inhabit their traditional shelters.",
        features: ["Native Spirit Houses", "Traditional Burial Grounds", "Strong Spiritual Presence", "Cultural Hauntings"],
        activityLevel: "moderate",
        yearEstablished: 1650,
        type: "Cemetery"
    },
    {
        id: "ak014",
        state: "AK",
        name: "Motherlode Lodge",
        city: "Palmer",
        coordinates: [61.5997, -149.1128],
        story: "This lodge is haunted by several unique spirits, with visitors reporting a misty black apparition that roams the grounds. One of the most chilling accounts involves the lodge's mirrors, where people looking into them have seen figures in period clothing standing behind them. It's as if the past is watching through the glass, with spirits from Alaska's frontier days refusing to move on from this historic location.",
        features: ["Misty Black Apparition", "Mirror Manifestations", "Period Clothing Spirits", "Ground-Roaming Entities"],
        activityLevel: "moderate",
        yearEstablished: 1940,
        type: "Lodge"
    },
    {
        id: "ak015",
        state: "AK",
        name: "Nightmute High School",
        city: "Nightmute",
        coordinates: [60.4711, -164.1967],
        story: "This remote high school has its own version of a bathroom-haunting ghost, similar to Moaning Myrtle from Harry Potter. A little girl haunts the school's bathrooms, flushing toilets and flicking lights on and off. Unlike fictional ghosts, she isn't confined to the bathroom and has been heard wandering the school humming and playing with basketballs in the gym. A grave discovered underneath room 106 may explain the origin of these hauntings.",
        features: ["Bathroom Poltergeist", "School Wandering Spirit", "Basketball Playing Ghost", "Mysterious Grave Discovery"],
        activityLevel: "moderate",
        yearEstablished: 1970,
        type: "School"
    },
    {
        id: "ak016",
        state: "AK",
        name: "Igloo City Hotel",
        city: "Cantwell",
        coordinates: [63.3925, -148.9181],
        story: "This distinctive igloo-shaped four-story structure sits abandoned on an isolated stretch of the Parks Highway. Built in the 1970s but never completed, it's unclear whether it failed to meet building codes or developers ran out of money. The abandoned hotel is now alleged to be haunted, with many reports of strange lights coming from inside the structure and regular sightings of a woman in white looking out of one of the windows.",
        features: ["Igloo-Shaped Building", "Woman in White", "Strange Interior Lights", "Incomplete Construction"],
        activityLevel: "moderate",
        yearEstablished: 1970,
        type: "Abandoned Hotel"
    },
    {
        id: "ak017",
        state: "AK",
        name: "1902 White House Bed and Breakfast",
        city: "Anchorage",
        coordinates: [61.2156, -149.8931],
        story: "This building served as a hospital, daycare, and hotel before becoming a bed and breakfast. In the 1980s, the building was set aflame and sat abandoned before being restored. Following restoration, apparitions began to appear, including a friendly younger woman who is chatty with children. Guests believe she was the former owner of the daycare, returning to her beloved job after death to continue caring for children.",
        features: ["Former Daycare Owner Spirit", "Child-Friendly Ghost", "Fire Restoration Connection", "Multiple Building Uses"],
        activityLevel: "low",
        yearEstablished: 1902,
        type: "Bed & Breakfast"
    },
    {
        id: "ak018",
        state: "AK",
        name: "West High School Auditorium",
        city: "Anchorage",
        coordinates: [61.1956, -149.9344],
        story: "The old auditorium of Anchorage's West High School is haunted by a lady in white who has been spotted for decades. Sometimes she stands silently among darkened seats in the cavernous space, sometimes flees through corridors, and sometimes lurks backstage or in the fluorescent-lit basement halls. Theater students and staff have reported her presence during rehearsals and performances, creating an eerie atmosphere in this educational setting.",
        features: ["Lady in White", "Auditorium Apparitions", "Backstage Hauntings", "Student Witness Accounts"],
        activityLevel: "moderate",
        yearEstablished: 1953,
        type: "School"
    },
    {
        id: "ak019",
        state: "AK",
        name: "Ship Creek",
        city: "Anchorage",
        coordinates: [61.2339, -149.8714],
        story: "Ship Creek is renowned for its eerie atmosphere and ghostly tales, particularly the spirit of a Native Alaskan woman named Marie who was murdered in 1987. Visitors report hearing her cries for help and seeing her apparition running alongside the creek. Her murder remains unsolved to this day, and her restless spirit continues to seek justice while wandering the creek where she met her tragic end.",
        features: ["Murder Victim Spirit", "Cries for Help", "Unsolved Crime Ghost", "Creek-Side Apparitions"],
        activityLevel: "moderate",
        yearEstablished: 1987,
        type: "Natural Area"
    },
    {
        id: "ak020",
        state: "AK",
        name: "Dimond Center Mall",
        city: "Anchorage",
        coordinates: [61.1458, -149.8683],
        story: "According to local legend, this mall was built over an ancient Alaska Native burial ground. People tell stories of hearing traditional flute and drum music echoing through the corridors, seeing transparent wolves inside the mall, and encountering ghostly people dressed in traditional Native clothing. Strange lights and unexplained smells also manifest throughout the shopping center, suggesting the disturbed spirits are making their presence known.",
        features: ["Native Burial Ground", "Traditional Music Sounds", "Transparent Wolf Spirits", "Cultural Apparitions"],
        activityLevel: "moderate",
        yearEstablished: 1977,
        type: "Shopping Mall"
    },
    {
        id: "ak021",
        state: "AK",
        name: "Site Summit",
        city: "Eagle River",
        coordinates: [61.2889, -149.3306],
        story: "The ruins atop a mountain high above Eagle River are haunted by the ghosts of a war that never came. This Cold War-era site housed surface-to-air missiles intended to destroy Soviet aircraft. The empty concrete buildings and bunkers create a spooky atmosphere, and the psychological weight of preparing for global catastrophe has left spiritual imprints. It's considered one of the most eerie places on Earth due to its apocalyptic purpose.",
        features: ["Cold War Spirits", "Military Installation Ghost", "Apocalyptic Atmosphere", "Mountain Top Isolation"],
        activityLevel: "moderate",
        yearEstablished: 1959,
        type: "Military Site"
    },
    {
        id: "ak022",
        state: "AK",
        name: "Portlock Ghost Town",
        city: "Port Chatham",
        coordinates: [59.3500, -151.7500],
        story: "This abandoned village on the southern tip of the Kenai Peninsula was evacuated in 1950 after residents reported continuous attacks by an unexplained hairy creature. The entity allegedly murdered villagers and left their bodies until everyone fled in terror. In the 1970s, a fisherman taking refuge from a storm reported something walking through their camp on two feet. Seventy years later, the hauntings continue for anyone brave enough to visit.",
        features: ["Bigfoot-Type Entity", "Mass Village Evacuation", "Continuing Attacks", "Cryptid Encounters"],
        activityLevel: "high",
        yearEstablished: 1787,
        type: "Ghost Town"
    },
    {
        id: "ak023",
        state: "AK",
        name: "Independence Mine",
        city: "Hatcher Pass",
        coordinates: [61.7833, -149.2833],
        story: "High in the Talkeetna Mountains, this abandoned gold mining operation sits quietly under frequent fog cover. Visitors report hearing footsteps on gravel paths with no one around, doors creaking open on still days, and cold spots in bunkhouses that haven't housed miners in decades. Some hear voices echoing from deep inside the tunnels, as if the miners never stopped working the claims that made this site profitable.",
        features: ["Phantom Footsteps", "Mining Tunnel Voices", "Bunkhouse Cold Spots", "Mountain Mining Spirits"],
        activityLevel: "moderate",
        yearEstablished: 1906,
        type: "Ghost Town"
    },
    {
        id: "ak024",
        state: "AK",
        name: "Dyea Ghost Town",
        city: "Skagway",
        coordinates: [59.4833, -135.3333],
        story: "This small ghost town outside Skagway was the staging spot for gold miners heading up the Chilkoot Trail during the 1897-1898 Klondike Gold Rush. The town was devastated by the Palm Sunday Avalanche on April 3, 1898, which killed at least 65 people, though the actual number is believed to be much higher. The Slide Cemetery remains as proof of the tragedy, and visitors report seeing gold rush-era spirits still preparing for their journey to the goldfields.",
        features: ["Avalanche Victim Spirits", "Gold Rush Era Ghosts", "Slide Cemetery Connection", "Klondike Trail Spirits"],
        activityLevel: "moderate",
        yearEstablished: 1880,
        type: "Ghost Town"
    },
    {
        id: "ak025",
        state: "AK",
        name: "Chena Hot Springs Resort",
        city: "Fairbanks",
        coordinates: [65.0544, -146.0578],
        story: "This historic resort, established in 1905, is built around natural hot springs that were considered sacred by indigenous peoples. Guests report seeing apparitions of early pioneers and Native spirits in the steam rising from the hot pools. The combination of the sacred nature of the springs and over a century of visitors has created layers of spiritual energy. Strange lights dance above the pools at night, and disembodied voices speak in unknown languages.",
        features: ["Sacred Hot Springs", "Pioneer Apparitions", "Native Spirits", "Steam Manifestations"],
        activityLevel: "moderate",
        yearEstablished: 1905,
        type: "Resort"
    },
    {
        id: "ak026",
        state: "AK",
        name: "Treadwell Mine Ruins",
        city: "Douglas",
        coordinates: [58.2739, -134.3578],
        story: "Once the largest gold mine in the world, Treadwell operated from 1881 to 1917 when a catastrophic cave-in caused by over-mining sent much of the operation into the ocean. The mine employed over 2,000 workers at its peak. Visitors to the ruins report hearing the sounds of pickaxes and machinery echoing from the collapsed tunnels, and seeing the spirits of miners who were trapped in the cave-in still trying to complete their work.",
        features: ["Mining Disaster Spirits", "Pickaxe Sounds", "Collapsed Tunnel Voices", "Industrial Ghost Activity"],
        activityLevel: "moderate",
        yearEstablished: 1881,
        type: "Ghost Town"
    },
    {
        id: "ak027",
        state: "AK",
        name: "Chitina Ghost Town",
        city: "Chitina",
        coordinates: [61.5158, -144.4381],
        story: "This former railroad town was abandoned from the 1940s to the 1970s when the Copper River Northwestern Railroad shut down. The town served as the end of the line for trains carrying copper from the Kennecott mines. During its abandonment, visitors reported seeing phantom trains arriving at the empty station and hearing the whistle of locomotives that no longer existed. The town has been partially resettled, but the ghostly trains still appear on foggy nights.",
        features: ["Phantom Train Arrivals", "Locomotive Whistles", "Railroad Station Spirits", "Copper Transport Ghosts"],
        activityLevel: "moderate",
        yearEstablished: 1911,
        type: "Ghost Town"
    },
    {
        id: "ak028",
        state: "AK",
        name: "Knik Glacier",
        city: "Palmer",
        coordinates: [61.4167, -148.9167],
        story: "This massive glacier has been the site of numerous plane crashes and mountaineering accidents over the decades. The extreme cold preserves bodies and wreckage for years, creating a supernatural atmosphere. Helicopter pilots report seeing figures waving from the ice where no one should be, and rescue teams have followed distress signals to empty locations. The spirits of those lost in the glacier's crevasses are said to still call out for help.",
        features: ["Crash Victim Spirits", "Ice Preservation Phenomena", "Phantom Distress Signals", "Glacial Apparitions"],
        activityLevel: "moderate",
        yearEstablished: 1898,
        type: "Natural Area"
    },
    {
        id: "ak029",
        state: "AK",
        name: "Iditarod Ghost Town",
        city: "Iditarod",
        coordinates: [62.5453, -158.1306],
        story: "Once a booming gold mining town with over 10,000 residents during the early 1900s, Iditarod is now a virtual ghost town. The famous Iditarod Trail Sled Dog Race takes its name from this historic location. Mushers and visitors report seeing spectral dog teams running the trail at night, complete with phantom mushers calling commands. The spirits of both sled dogs and their human companions who perished on the dangerous trail continue their eternal race.",
        features: ["Phantom Dog Teams", "Musher Spirits", "Trail Running Ghosts", "Sled Dog Apparitions"],
        activityLevel: "moderate",
        yearEstablished: 1908,
        type: "Ghost Town"
    },
    {
        id: "ak030",
        state: "AK",
        name: "Fort Egbert",
        city: "Eagle",
        coordinates: [64.7878, -141.2014],
        story: "Established in 1899 with a population of nearly 1,800 miners and residents hoping to find gold, Fort Egbert was abandoned when other cities offered better opportunities. This military outpost was essential to Alaska's early communication systems. Five original buildings remain, and visitors report seeing uniformed soldiers still manning their posts. The spirits of frontier soldiers continue their eternal watch over this remote outpost on the edge of the world.",
        features: ["Frontier Soldier Spirits", "Military Post Ghosts", "Communication System Spirits", "Remote Outpost Activity"],
        activityLevel: "moderate",
        yearEstablished: 1899,
        type: "Military Site"
    },
    {
        id: "ak031",
        state: "AK",
        name: "Nome Cemetery",
        city: "Nome",
        coordinates: [64.5011, -165.4064],
        story: "This cemetery on the edge of the Bering Sea contains the graves of countless gold rush prospectors who died seeking their fortunes. The harsh Arctic conditions and isolation created desperate circumstances for many. Visitors report seeing ghostly figures with pickaxes and gold pans wandering between the graves, still searching for the strike that eluded them in life. The sound of picks hitting permafrost echoes across the tundra on quiet nights.",
        features: ["Gold Rush Prospector Spirits", "Pickaxe Sounds", "Arctic Isolation Ghosts", "Permafrost Digging Sounds"],
        activityLevel: "moderate",
        yearEstablished: 1900,
        type: "Cemetery"
    },
    {
        id: "ak032",
        state: "AK",
        name: "Valdez Museum",
        city: "Valdez",
        coordinates: [61.1308, -146.3483],
        story: "This museum houses artifacts from the devastating 1964 Great Alaska Earthquake and the 1989 Exxon Valdez oil spill. Staff and visitors report paranormal activity related to these traumatic events, including the spirits of earthquake victims and oil spill cleanup workers. Exhibits move on their own, and visitors feel an overwhelming sadness when viewing disaster-related displays. The accumulated trauma of these events has left lasting spiritual imprints.",
        features: ["Earthquake Victim Spirits", "Oil Spill Worker Ghosts", "Moving Exhibits", "Disaster Trauma Imprints"],
        activityLevel: "moderate",
        yearEstablished: 1967,
        type: "Museum"
    },
    {
        id: "ak033",
        state: "AK",
        name: "Barrow Research Station",
        city: "Utqiagvik",
        coordinates: [71.2906, -156.7886],
        story: "This northernmost research station experiences months of continuous darkness, creating an otherworldly atmosphere. Researchers report seeing figures in the permanent twilight that disappear when approached. The extreme isolation and psychological effects of endless night have created spiritual phenomena. Scientists have documented unexplained equipment malfunctions and strange readings during the darkest months, suggesting supernatural interference with their work.",
        features: ["Polar Night Apparitions", "Equipment Malfunctions", "Isolation-Induced Spirits", "Arctic Research Ghosts"],
        activityLevel: "moderate",
        yearEstablished: 1947,
        type: "Research Station"
    },
    {
        id: "ak034",
        state: "AK",
        name: "Glacier Bay Lodge",
        city: "Gustavus",
        coordinates: [58.4200, -135.7072],
        story: "This remote wilderness lodge in Glacier Bay National Park is haunted by the spirits of early explorers and researchers who studied the rapidly changing glacial landscape. Guests report seeing figures in period exploration gear watching the glaciers from lodge windows. The dramatic environmental changes caused by climate change have awakened ancient spirits tied to the ice. Strange lights move across the glaciers at night, visible from the lodge.",
        features: ["Explorer Spirits", "Glacial Change Ghosts", "Window Apparitions", "Ancient Ice Spirits"],
        activityLevel: "low",
        yearEstablished: 1965,
        type: "Lodge"
    },
    {
        id: "ak035",
        state: "AK",
        name: "Russian Bishop's House",
        city: "Sitka",
        coordinates: [57.0531, -135.3300],
        story: "Built in 1842 for Russian Orthodox Bishop Innocent Veniaminov, this historic building served as the center of Russian Orthodox Christianity in Alaska. The bishop's spirit is said to still walk the halls, continuing his missionary work from beyond. Visitors report hearing Orthodox chanting echoing through empty rooms and seeing the bishop in his traditional robes blessing invisible congregations. The building's sacred history has created powerful spiritual energy.",
        features: ["Russian Orthodox Bishop Spirit", "Sacred Chanting Sounds", "Religious Apparitions", "Missionary Ghost Activity"],
        activityLevel: "moderate",
        yearEstablished: 1842,
        type: "Historic Building"
    },
    {
        id: "ak036",
        state: "AK",
        name: "Anvil Creek",
        city: "Nome",
        coordinates: [64.5167, -165.3833],
        story: "This creek was the site of the first major gold discovery that sparked the Nome Gold Rush in 1899. Thousands of prospectors worked these waters under brutal conditions. Many died from exposure, disease, and mining accidents. Their spirits continue to work the creek, with modern visitors hearing the sounds of sluice boxes and seeing phantom miners panning for gold. The desperate hope and crushing disappointment of the gold rush era still echoes along these waters.",
        features: ["Gold Rush Miner Spirits", "Phantom Panning Sounds", "Sluice Box Noises", "Creek Working Ghosts"],
        activityLevel: "moderate",
        yearEstablished: 1899,
        type: "Natural Area"
    },
    {
        id: "ak037",
        state: "AK",
        name: "Fairbanks Exploration Company Dredges",
        city: "Fairbanks",
        coordinates: [64.8378, -147.7164],
        story: "These massive gold dredges operated from the 1920s through the 1960s, processing millions of cubic yards of permafrost. Workers faced dangerous conditions in the mechanical monsters, and several fatal accidents occurred. The abandoned dredges are now haunted by the spirits of workers who died operating the machinery. Visitors hear the phantom sounds of dredging operations and see ghostly figures maintaining equipment that no longer functions.",
        features: ["Industrial Worker Spirits", "Phantom Machinery Sounds", "Gold Dredge Ghosts", "Mining Equipment Apparitions"],
        activityLevel: "moderate",
        yearEstablished: 1925,
        type: "Industrial Site"
    },
    {
        id: "ak038",
        state: "AK",
        name: "Klondike Gold Rush National Historical Park",
        city: "Skagway",
        coordinates: [59.4600, -135.3100],
        story: "This park preserves the history of the 1897-1898 Klondike Gold Rush along the Chilkoot and White Pass trails. Thousands of stampeders attempted the treacherous journey to the Canadian goldfields, and many died along the way from avalanches, exposure, and accidents. Park rangers and visitors report seeing ghostly prospectors still making their way up the trails, laden with supplies, forever seeking the golden dreams that eluded them in life.",
        features: ["Stampeder Spirits", "Trail Hiking Ghosts", "Gold Rush Prospector Apparitions", "Supply-Laden Phantoms"],
        activityLevel: "moderate",
        yearEstablished: 1897,
        type: "Historic Park"
    },
    {
        id: "ak039",
        state: "AK",
        name: "Susitna River",
        city: "Talkeetna",
        coordinates: [62.3203, -150.1064],
        story: "Known locally as the 'Big Su,' this dangerous river has claimed numerous lives over the decades from drownings, plane crashes, and boating accidents. The glacial waters and unpredictable currents create treacherous conditions. Fishermen and pilots report seeing figures in the water calling for help, and rescue teams have responded to phantom distress calls. The spirits of those claimed by the river continue to struggle against its powerful currents.",
        features: ["Drowning Victim Spirits", "Phantom Distress Calls", "River Current Ghosts", "Water Accident Apparitions"],
        activityLevel: "moderate",
        yearEstablished: 1898,
        type: "Natural Area"
    },
    {
        id: "ak040",
        state: "AK",
        name: "Alaska State Hospital",
        city: "Anchorage",
        coordinates: [61.1950, -149.8231],
        story: "This former psychiatric hospital operated for decades treating mental health patients under often harsh conditions typical of mid-20th century institutions. Staff and visitors report hearing patients' voices echoing through abandoned wings, seeing figures in hospital gowns wandering empty corridors, and feeling overwhelming sadness in former treatment rooms. The accumulated suffering and inadequate care created lasting spiritual imprints throughout the facility.",
        features: ["Patient Spirit Voices", "Hospital Gown Apparitions", "Treatment Room Sadness", "Medical Institution Ghosts"],
        activityLevel: "high",
        yearEstablished: 1962,
        type: "Hospital"
    },
    {
        id: "ak041",
        state: "AK",
        name: "Attu Island",
        city: "Attu Station",
        coordinates: [52.8483, 173.1908],
        story: "This remote Aleutian island was the site of the only World War II battle fought on American soil. During the Battle of Attu in 1943, over 2,850 Japanese and 549 American soldiers died in brutal fighting. The entire Aleut population was relocated and never returned. Visitors report seeing ghostly soldiers from both armies still fighting their eternal battle, and hearing gunfire and explosions echoing across the tundra on foggy days.",
        features: ["WWII Soldier Spirits", "Battle Sound Echoes", "Military Combat Ghosts", "War Zone Apparitions"],
        activityLevel: "high",
        yearEstablished: 1943,
        type: "Battlefield"
    },
    {
        id: "ak042",
        state: "AK",
        name: "Adak Naval Air Station",
        city: "Adak",
        coordinates: [51.8800, -176.6581],
        story: "This abandoned Cold War military installation on Adak Island housed thousands of personnel during its operation from 1942 to 1997. The harsh conditions and isolation took a psychological toll on many stationed there. The abandoned base is now haunted by the spirits of military personnel who couldn't leave their posts. Visitors report seeing uniformed figures patrolling empty barracks and hearing phantom aircraft taking off from the abandoned runway.",
        features: ["Cold War Military Spirits", "Phantom Aircraft Sounds", "Barracks Patrol Ghosts", "Abandoned Base Activity"],
        activityLevel: "moderate",
        yearEstablished: 1942,
        type: "Military Base"
    },
    {
        id: "ak043",
        state: "AK",
        name: "St. Michael",
        city: "St. Michael",
        coordinates: [63.4700, -162.0392],
        story: "This historic trading post and former territorial capital served as a major supply point during the gold rush era. The town declined after gold mining ended, leaving behind numerous abandoned buildings. Visitors report seeing ghostly traders and prospectors still conducting business in empty storefronts. The spirits of Yup'ik villagers who traded here for generations also remain, creating a multicultural haunting reflecting the town's diverse history.",
        features: ["Trading Post Spirits", "Prospector Business Ghosts", "Yup'ik Cultural Spirits", "Territorial Capital Phantoms"],
        activityLevel: "moderate",
        yearEstablished: 1833,
        type: "Trading Post"
    },
    {
        id: "ak044",
        state: "AK",
        name: "Copper Center Lodge",
        city: "Copper Center",
        coordinates: [61.9544, -145.3056],
        story: "This historic roadhouse served travelers on the Richardson Highway for over a century. Built in 1896, it provided crucial shelter during harsh Alaskan winters. Many travelers who didn't survive their journeys are said to still seek refuge at the lodge. Guests report seeing frost-covered apparitions entering the lobby during blizzards, and hearing desperate knocking on doors during storms when no one is outside.",
        features: ["Frost-Covered Apparitions", "Storm Shelter Spirits", "Desperate Knocking Sounds", "Winter Traveler Ghosts"],
        activityLevel: "moderate",
        yearEstablished: 1896,
        type: "Historic Lodge"
    },
    {
        id: "ak045",
        state: "AK",
        name: "Brooks Range",
        city: "Gates of the Arctic",
        coordinates: [68.0000, -153.0000],
        story: "This vast mountain range above the Arctic Circle has been the site of numerous disappearances and deaths over the decades. The extreme wilderness and isolation create an otherworldly atmosphere. Bush pilots report seeing campfires and figures waving from locations where no one should be. The spirits of lost explorers, crashed pilots, and missing hikers are said to still wander these peaks, forever trying to find their way home.",
        features: ["Lost Explorer Spirits", "Phantom Campfires", "Missing Person Ghosts", "Arctic Wilderness Apparitions"],
        activityLevel: "moderate",
        yearEstablished: 1929,
        type: "Mountain Range"
    },
    {
        id: "ak046",
        state: "AK",
        name: "Circle City",
        city: "Circle",
        coordinates: [65.8267, -144.0631],
        story: "Once called the 'Paris of Alaska' during the 1890s gold rush, Circle City had a population of over 1,200 when it was the largest settlement on the Yukon River. The town declined rapidly when gold was discovered in the Klondike, causing a mass exodus. The few remaining buildings are haunted by the spirits of prospectors who refused to abandon their claims, still believing they'll strike it rich in the played-out creeks.",
        features: ["Stubborn Prospector Spirits", "Gold Rush Era Ghosts", "Yukon River Trading Spirits", "Boom Town Phantoms"],
        activityLevel: "moderate",
        yearEstablished: 1893,
        type: "Ghost Town"
    },
    {
        id: "ak047",
        state: "AK",
        name: "Eielson Air Force Base",
        city: "Fairbanks",
        coordinates: [64.6656, -147.1031],
        story: "This strategic Air Force base has been operational since 1943, serving as a crucial Cold War installation. The extreme cold and high-stress military operations have contributed to several tragic accidents and deaths over the decades. Personnel report seeing ghostly aircraft on radar that don't exist, and maintenance crews encounter the spirits of fallen airmen still performing their duties in the hangars and on the flight line.",
        features: ["Phantom Radar Contacts", "Fallen Airmen Spirits", "Hangar Maintenance Ghosts", "Cold War Military Phantoms"],
        activityLevel: "moderate",
        yearEstablished: 1943,
        type: "Military Base"
    },
    {
        id: "ak048",
        state: "AK",
        name: "Denali National Park Headquarters",
        city: "Denali Park",
        coordinates: [63.7286, -148.9169],
        story: "The headquarters area of this vast national park has witnessed numerous mountaineering tragedies and disappearances over the decades. Rangers and visitors report seeing ghostly climbers in vintage gear still attempting to summit Denali. The spirits of those who died on the mountain are said to return to the headquarters, forever preparing for their next attempt to conquer North America's highest peak.",
        features: ["Mountaineer Spirits", "Vintage Climbing Gear Ghosts", "Summit Attempt Phantoms", "Alpine Tragedy Apparitions"],
        activityLevel: "moderate",
        yearEstablished: 1917,
        type: "National Park"
    },
    {
        id: "ak049",
        state: "AK",
        name: "Whittier Tunnel",
        city: "Whittier",
        coordinates: [60.7744, -148.6831],
        story: "This 2.5-mile tunnel through the Chugach Mountains is the longest highway tunnel in North America and the only land route to Whittier. Built for military use in 1943, the tunnel has been the site of several fatal accidents over the decades. Drivers report seeing ghostly figures walking through the tunnel and phantom headlights approaching from the opposite direction when no other vehicles are present.",
        features: ["Tunnel Walking Spirits", "Phantom Vehicle Lights", "Military Construction Ghosts", "Transportation Accident Phantoms"],
        activityLevel: "moderate",
        yearEstablished: 1943,
        type: "Transportation"
    },
    {
        id: "ak050",
        state: "AK",
        name: "Point Hope",
        city: "Point Hope",
        coordinates: [68.3486, -166.7992],
        story: "This ancient Inupiat village is one of the oldest continuously inhabited places in North America, with archaeological evidence of 2,000 years of occupation. The village sits on ancient burial grounds and sacred sites. Residents report seeing ancestors in traditional clothing walking the tundra, and hearing drums and singing carried on the Arctic wind. The deep cultural history and connection to the spirit world make this one of Alaska's most spiritually active locations.",
        features: ["Ancient Ancestor Spirits", "Traditional Clothing Apparitions", "Sacred Drumming Sounds", "Arctic Wind Voices"],
        activityLevel: "high",
        yearEstablished: 1000,
        type: "Native Village"
    }
        ];

        let currentDisplayedLocations = [];
 
        // Initialize the application
        function initializeApp() {
            updateStatistics();
            displayAllLocations();
        }
 
        // Filter and display locations based on current selections
        function filterAndDisplayLocations() {
            const stateFilter = document.getElementById('stateFilter').value;
            const typeFilter = document.getElementById('locationType').value;
            const activityFilter = document.getElementById('activityLevel').value;
            const sortOrder = document.getElementById('sortOrder').value;
 
            // Filter locations
            let filteredLocations = hauntedLocations.filter(location => {
                const stateMatch = !stateFilter || location.state === stateFilter;
                const typeMatch = !typeFilter || location.type === typeFilter;
                const activityMatch = !activityFilter || location.activityLevel === activityFilter;
                return stateMatch && typeMatch && activityMatch;
            });
 
            // Sort locations based on selected option
            filteredLocations = sortLocations(filteredLocations, sortOrder);
 
            currentDisplayedLocations = filteredLocations;
            
            // Show loading
            document.getElementById('locationsList').innerHTML = '<div class="loading">Filtering haunted locations...</div>';
            
            setTimeout(() => {
                displayLocationsOnMap(filteredLocations);
                displayLocationsList(filteredLocations);
                updateDisplayedCount(filteredLocations.length);
                
                // Center map on filtered results
                if (filteredLocations.length > 0) {
                    centerMapOnLocations(filteredLocations);
                }
            }, 1000);
        }
 
        // Sort locations based on selected criteria
        function sortLocations(locations, sortBy) {
            const sortedLocations = [...locations];
            
            switch(sortBy) {
                case 'alphabetical':
                    return sortedLocations.sort((a, b) => a.name.localeCompare(b.name));
                case 'alphabetical-desc':
                    return sortedLocations.sort((a, b) => b.name.localeCompare(a.name));
                case 'activity':
                    const activityOrder = { 'high': 3, 'moderate': 2, 'low': 1 };
                    return sortedLocations.sort((a, b) => {
                        const aOrder = activityOrder[a.activityLevel];
                        const bOrder = activityOrder[b.activityLevel];
                        return bOrder - aOrder;
                    });
                case 'year':
                    return sortedLocations.sort((a, b) => a.yearEstablished - b.yearEstablished);
                case 'type':
                    return sortedLocations.sort((a, b) => a.type.localeCompare(b.type));
                case 'city':
                    return sortedLocations.sort((a, b) => a.city.localeCompare(b.city));
                default:
                    return sortedLocations.sort((a, b) => a.name.localeCompare(b.name));
            }
        }
 
        // Display all locations initially
        function displayAllLocations() {
            const sortOrder = document.getElementById('sortOrder')?.value || 'alphabetical';
            const sortedLocations = sortLocations(hauntedLocations, sortOrder);
            currentDisplayedLocations = sortedLocations;
            displayLocationsOnMap(sortedLocations);
            displayLocationsList(sortedLocations);
            updateDisplayedCount(sortedLocations.length);
        }
 
        // Center map on a set of locations
        function centerMapOnLocations(locations) {
            if (locations.length === 0) return;
            
            if (locations.length === 1) {
                map.setView(locations[0].coordinates, 10);
            } else {
                const group = new L.featureGroup(locations.map(loc => 
                    L.marker(loc.coordinates)
                ));
                map.fitBounds(group.getBounds().pad(0.1));
            }
        }
 
        // Display locations on map
        function displayLocationsOnMap(locations) {
            markersGroup.clearLayers();
 
            locations.forEach(location => {
                const hauntedIcon = L.divIcon({
                    className: 'haunted-marker',
                    html: '📍',
                    iconSize: [24, 24],
                    iconAnchor: [12, 12]
                });
 
                const marker = L.marker(location.coordinates, {
                    icon: hauntedIcon
                }).addTo(markersGroup);
 
                const popupContent = `
                    <div style="max-width: 300px;">
                        <h3 style="margin-bottom: 10px;">${location.name}</h3>
                        ${location.imageUrl ? `
                            <img src="${location.imageUrl}" 
                                 alt="${location.name}" 
                                 style="width: 100%; max-width: 280px; height: 180px; object-fit: cover; border-radius: 5px; margin-bottom: 10px;"
                                 onerror="this.style.display='none'">
                        ` : ''}
                        <p style="margin-bottom: 5px;"><strong>Location:</strong> ${location.city}, ${location.state}</p>
                        <p style="margin-bottom: 5px;"><strong>Type:</strong> ${location.type}</p>
                        <p style="margin-bottom: 5px;"><strong>Established:</strong> ${location.yearEstablished}</p>
                        <p style="margin-bottom: 10px;"><strong>Activity Level:</strong> <span style="color: ${location.activityLevel === 'high' ? '#ff4444' : location.activityLevel === 'moderate' ? '#ffaa44' : '#44ff44'};">${location.activityLevel.toUpperCase()}</span></p>
                        <div style="margin-bottom: 10px;">
                            <strong>Story:</strong>
                            <p style="margin-top: 5px; line-height: 1.4; font-size: 0.9em;">${location.story}</p>
                        </div>
                        <div style="margin-bottom: 10px;">
                            <strong>Reported Phenomena:</strong>
                            <div style="margin-top: 5px; display: flex; flex-wrap: wrap; gap: 4px;">
                                ${location.features.map(feature => `<span style="background: rgba(255, 107, 53, 0.2); color: #ff6b35; padding: 2px 6px; border-radius: 8px; font-size: 0.8em; border: 1px solid rgba(255, 107, 53, 0.3);">${feature}</span>`).join('')}
                            </div>
                        </div>
                        ${location.imageSource ? `<div style="text-align: center;"><span style="background: rgba(255, 107, 53, 0.2); color: #ff6b35; padding: 2px 6px; border-radius: 8px; font-size: 0.7em; border: 1px solid rgba(255, 107, 53, 0.3);">📸 ${location.imageSource}</span></div>` : ''}
                    </div>
                `;
 
                marker.bindPopup(popupContent, {
                    maxWidth: 320,
                    maxHeight: 400,
                    className: 'haunted-popup'
                });

                marker.on('click', () => {
                    marker.openPopup();
                });
            });
        }
 
        // Display locations list
        function displayLocationsList(locations) {
            const listContainer = document.getElementById('locationsList');
            
            listContainer.innerHTML = locations.map(location => `
                <div class="location-card activity-${location.activityLevel}" data-id="${location.id}">
                    ${location.imageUrl ? `
                        <div class="location-image">
                            <img src="${location.imageUrl}" 
                                 alt="${location.name}" 
                                 onerror="this.style.display='none'"
                                 loading="lazy">
                        </div>
                    ` : ''}
                    <div class="location-title">${location.name}</div>
                    <div class="coordinates">${location.city}, ${location.state}</div>
                    <div class="location-type">${location.type}</div>
                    <div class="location-story">${location.story}</div>
                    <div class="location-features">
                        <h4>Reported Phenomena:</h4>
                        <div class="features-list">
                            ${location.features.map(feature => `<span class="feature-tag">${feature}</span>`).join('')}
                        </div>
                    </div>
                    ${location.imageSource ? `<div class="image-source-badge">Source: ${location.imageSource}</div>` : ''}
                </div>
            `).join('');
        }
 
        // Update statistics
        function updateStatistics() {
            const totalCount = hauntedLocations.length;
            const highActivityCount = hauntedLocations.filter(loc => loc.activityLevel === 'high').length;
            
            document.getElementById('totalLocations').textContent = totalCount;
            document.getElementById('highActivity').textContent = highActivityCount;
        }
 
        // Update displayed count
        function updateDisplayedCount(count) {
            document.getElementById('displayedCount').textContent = count;
        }
 
        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', () => {
            initializeApp();
        });
 
        // Add event listeners for filtering
        document.getElementById('stateFilter').addEventListener('change', filterAndDisplayLocations);
        document.getElementById('locationType').addEventListener('change', filterAndDisplayLocations);
        document.getElementById('activityLevel').addEventListener('change', filterAndDisplayLocations);
        document.getElementById('sortOrder').addEventListener('change', filterAndDisplayLocations);
    </script>
</body>
</html>
